import{T as h,f}from"./services.99864b47.js";import{t as C,s as c}from"./tasks.e8742239.js";import{d as w,_ as g,c as p,w as t,a as n,o,b as a,e as V,f as b,g as v,h as y,i as k,j as i,V as S,m as u,H as F,n as d,p as r,x as m,C as T,I as $,F as B,l as L,q as M,r as _}from"./index.4ac873d2.js";const D=w({name:"CreateFlow",props:{showProp:Boolean},watch:{showProp:{handler(e,l){this.show=e}}},data(){return{selectedStep:h.Delay,stepComponents:[],stepMap:new Map,stepTypes:C,show:this.showProp,item:{},saveLoading:!1}},computed:{getSteps(){return this.stepComponents}},methods:{async addStep(){this.stepComponents.push({c:c.get(this.selectedStep),i:this.stepComponents.length+1})},stepChanged(e){console.log(e),this.stepMap.set(e.weight,e)},labelRules(){return[e=>this.item.label?!0:"label is required"]},async labelChanged(e){await this.validate()},async validate(){const{valid:e}=await this.$refs["label-input"].validate();return e},async validateForm(){const{valid:e}=await this.$refs["flow-form"].validate();return e},async CreateFlow(){if(!!await this.validateForm())try{this.saveLoading=!0;const e=[];this.stepMap.forEach(l=>{e.push(l)}),this.item.tasks=e,await f.flowServiceCreateFlow({body:this.item}),this.$emit("change",!1),this.$emit("Created")}catch(e){console.error(e),this.saveLoading=!1}},Close(){this.$emit("change",!1)}}}),I=_("span",{class:"text-h5"},"Create flow",-1);function N(e,l,P,R,U,j){return o(),p(n,{justify:"center"},{default:t(()=>[a(M,{modelValue:e.show,"onUpdate:modelValue":l[2]||(l[2]=s=>e.show=s),persistent:"",width:"80%",height:"80%","min-height":"80"},{default:t(()=>[a(V,null,{default:t(()=>[a(b,null,{default:t(()=>[I]),_:1}),a(v,null,{default:t(()=>[a(y,null,{default:t(()=>[a(k,{"validate-on":"submit",ref:"flow-form"},{default:t(()=>[a(n,null,{default:t(()=>[a(i,{cols:"12",sm:"6",md:"4"},{default:t(()=>[a(S,{ref:"label-input",modelValue:e.item.label,"onUpdate:modelValue":l[0]||(l[0]=s=>e.item.label=s),label:"label",density:"comfortable",variant:"outlined",rules:e.labelRules(),onInput:e.labelChanged},null,8,["modelValue","rules","onInput"])]),_:1})]),_:1}),a(u),a(n,null,{default:t(()=>[a(i,null,{default:t(()=>[a(F,{modelValue:e.selectedStep,"onUpdate:modelValue":l[1]||(l[1]=s=>e.selectedStep=s),items:e.stepTypes},null,8,["modelValue","items"])]),_:1}),a(i,null,{default:t(()=>[a(d,{class:"ma-2",onClick:e.addStep},{default:t(()=>[r("Add step")]),_:1},8,["onClick"])]),_:1})]),_:1}),(o(!0),m(B,null,T(e.getSteps,s=>(o(),m("div",null,[(o(),p($(s.c),{class:"mb-5",onStepChanged:e.stepChanged,style:{"box-shadow":"rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px"},disabled:!1,weight:s.i},null,40,["onStepChanged","weight"]))]))),256))]),_:1},512)]),_:1})]),_:1}),a(L,null,{default:t(()=>[a(u),a(d,{color:"blue-darken-1",variant:"text",onClick:e.Close},{default:t(()=>[r(" Close ")]),_:1},8,["onClick"]),a(d,{type:"submit",color:"blue-darken-1",variant:"text",disabled:e.saveLoading,loading:e.saveLoading,onClick:e.CreateFlow},{default:t(()=>[r(" Save ")]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const E=g(D,[["render",N]]);export{E as C};
